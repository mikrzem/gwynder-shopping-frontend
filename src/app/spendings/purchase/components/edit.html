<div class="card"
     *ngIf="purchase">
    <div class="card-header">
        <h4 class="card-title">Purchase</h4>
    </div>
    <div class="card-body">
        <div class="row form-group">
            <label class="col-md-4">
                Date
            </label>
            <div class="col-md-8">
                <date-select [(value)]="purchase.date"></date-select>
            </div>
        </div>
        <div class="row form-group">
            <label class="col-md-4">
                Location
            </label>
            <div class="col-md-8">
                <location-select [(location)]="purchase.location"></location-select>
            </div>
        </div>
        <div class="row form-group">
            <label class="col-md-4">
                Category
            </label>
            <div class="col-md-8">
                <category-select [(category)]="purchase.category"></category-select>
            </div>
        </div>
        <div class="row form-group">
            <div class="col-md-12">
                <table class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Amount</th>
                            <th>Price</th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let product of purchase.products">
                            <td>
                                {{product.product.name}}
                            </td>
                            <td>
                                <input type="number"
                                       class="form-control"
                                       step="1"
                                       min="0"
                                       [(ngModel)]="product.amount"/>
                            </td>
                            <td>
                                <input type="number"
                                       class="form-control"
                                       step="0.01"
                                       min="0"
                                       [(ngModel)]="product.price"/>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr class="sum-table-row">
                            <td>
                                Total
                            </td>
                            <td>
                                <label>
                                    <input type="checkbox"
                                           [(ngModel)]="manual"/>
                                    Manual
                                </label>
                            </td>
                            <td>
                                <input type="text"
                                       class="form-control"
                                       [(ngModel)]="total"
                                       [disabled]="!manual"/>
                            </td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        Next product
                    </div>
                    <div class="card-body">
                        <div class="row form-group">
                            <label class="col-md-4">
                                Product
                            </label>
                            <div class="col-md-8">
                                <product-select [(product)]="nextProduct.product"
                                                [parentCategory]="purchase.category">
                                </product-select>
                            </div>
                        </div>
                        <div class="row form-group">
                            <label class="col-md-4"
                                   for="next-amount">
                                Amount
                            </label>
                            <div class="col-md-8">
                                <input type="number"
                                       class="form-control"
                                       [(ngModel)]="nextProduct.amount"
                                       id="next-amount"
                                       step="1"/>
                            </div>
                        </div>
                        <div class="row form-group">
                            <label class="col-md-4"
                                   for="next-price">
                                Price
                            </label>
                            <div class="col-md-8">
                                <input type="number"
                                       class="form-control"
                                       [(ngModel)]="nextProduct.price"
                                       id="next-price"
                                       step="0.01"/>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <button type="button"
                                class="btn btn-block btn-primary"
                                (click)="addNextProduct()">
                            <span class="fa fa-plus-square-o"></span>
                            Add next product
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="card-footer">
        <div class="row">
            <div class="col-md-8">
                <button type="button"
                        class="btn btn-block btn-primary"
                        (click)="save()">
                    <span class="fa fa-save"></span>
                    Save purchase
                </button>
            </div>
            <div class="col-md-4">
                <button type="button"
                        class="btn btn-block btn-secondary"
                        (click)="cancel()">
                    Cancel
                </button>
            </div>
        </div>
    </div>
</div>
